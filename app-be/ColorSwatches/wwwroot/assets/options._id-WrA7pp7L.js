import{a as c,r as w,E as I,i as ce,h as de,j as a,f as he,k as ue}from"./index-Ckg9rGMJ.js";import{c as G,n as ge,v as pe,I as J,o as me,p as ve,b as fe,T as D,q as be,B as M,k as xe,l as A,S as Ce,P as Se,j as we,e as $,A as ye,r as je,U as Pe,s as Ne}from"./index-CPzNQa-k.js";function S(s,t,e){return s<t?t:s>e?e:s}function Ee(s,t){const e=s/60,r=1-Math.abs(e%2-1),n=t*r;let i=0,l=0,o=0;return e>=0&&e<=1&&(i=t,l=n,o=0),e>=1&&e<=2&&(i=n,l=t,o=0),e>=2&&e<=3&&(i=0,l=t,o=n),e>=3&&e<=4&&(i=0,l=n,o=t),e>=4&&e<=5&&(i=n,l=0,o=t),e>=5&&e<=6&&(i=t,l=0,o=n),{red:i,green:l,blue:o}}function Q(s){const{hue:t,saturation:e,brightness:r,alpha:n=1}=s,i=r*e;let{red:l,green:o,blue:g}=Ee(t,i);const h=r-i;return l+=h,o+=h,g+=h,{red:Math.round(l*255),green:Math.round(o*255),blue:Math.round(g*255),alpha:n}}var ee=function(t){return c.createElement("svg",Object.assign({viewBox:"0 0 20 20"},t),c.createElement("path",{d:"M10.75 5.75c0-.414-.336-.75-.75-.75s-.75.336-.75.75v3.5h-3.5c-.414 0-.75.336-.75.75s.336.75.75.75h3.5v3.5c0 .414.336.75.75.75s.75-.336.75-.75v-3.5h3.5c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-3.5v-3.5Z"}))};ee.displayName="PlusIcon";var te=function(t){return c.createElement("svg",Object.assign({viewBox:"0 0 20 20"},t),c.createElement("path",{d:"M16.5 6.26a.75.75 0 0 1-1.5 0v-.51a.75.75 0 0 0-.75-.75h-8.5a.75.75 0 0 0-.75.75v.51a.75.75 0 0 1-1.5 0v-.51a2.25 2.25 0 0 1 2.25-2.25h8.5a2.25 2.25 0 0 1 2.25 2.25v.51Z"}),c.createElement("path",{d:"M10.75 16.01a.75.75 0 0 1-1.5 0v-6.69l-1.72 1.72a.75.75 0 1 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 1 1-1.06 1.06l-1.72-1.72v6.69Z"}))};te.displayName="UploadIcon";var P={ColorPicker:"Polaris-ColorPicker",MainColor:"Polaris-ColorPicker__MainColor",fullWidth:"Polaris-ColorPicker--fullWidth",Dragger:"Polaris-ColorPicker__Dragger",ColorLayer:"Polaris-ColorPicker__ColorLayer",HuePicker:"Polaris-ColorPicker__HuePicker",AlphaPicker:"Polaris-ColorPicker__AlphaPicker",Slidable:"Polaris-ColorPicker__Slidable"};const R=13;function ke(s,t,e){const r=He(s,t,e);return S(r,0,t)}function De(s,t){const e=S(s,0,t);return Me(e,t)}function Me(s,t){const e=s-R,r=t-R*2;return S(1-e/r,0,1)}function He(s,t,e){const r=t-(e+R);return S((1-s)*r+R,0,t-e)}let z=!1;ce||window.addEventListener("touchmove",s=>{z&&s.preventDefault()},{passive:!1});class B extends w.PureComponent{constructor(...t){super(...t),this.state={dragging:!1},this.node=null,this.draggerNode=null,this.setDraggerNode=e=>{this.draggerNode=e},this.setNode=e=>{this.node=e},this.startDrag=e=>{Ae(e)&&this.handleDraggerMove(e.clientX,e.clientY),z=!0,this.setState({dragging:!0})},this.handleDragEnd=()=>{z=!1,this.setState({dragging:!1})},this.handleMove=e=>{if(e.stopImmediatePropagation(),e.stopPropagation(),e.cancelable&&e.preventDefault(),Ie(e)){this.handleDraggerMove(e.clientX,e.clientY);return}this.handleDraggerMove(e.touches[0].clientX,e.touches[0].clientY)},this.handleDraggerMove=(e,r)=>{if(this.node==null)return;const{onChange:n}=this.props,i=this.node.getBoundingClientRect(),l=e-i.left,o=r-i.top;n({x:l,y:o})}}componentWillUnmount(){var t;(t=this.observer)==null||t.disconnect()}componentDidMount(){this.node&&(this.observer=new ResizeObserver(()=>{var e,r;const{window:t}=this.state;t!==((e=this.node)==null?void 0:e.ownerDocument.defaultView)&&this.setState({window:(r=this.node)==null?void 0:r.ownerDocument.defaultView}),this.handleResize()}),this.observer.observe(this.node),this.handleResize())}render(){const{dragging:t,window:e}=this.state,{draggerX:r=0,draggerY:n=0}=this.props,i={transform:`translate3d(${r}px, ${n}px, 0)`},l=t?c.createElement(I,{event:"mousemove",handler:this.handleMove,passive:!1,window:e}):null,o=t?c.createElement(I,{event:"touchmove",handler:this.handleMove,passive:!1,window:e}):null,g=t?c.createElement(I,{event:"mouseup",handler:this.handleDragEnd,window:e}):null,h=t?c.createElement(I,{event:"touchend",handler:this.handleDragEnd,window:e}):null,p=t?c.createElement(I,{event:"touchcancel",handler:this.handleDragEnd,window:e}):null;return c.createElement("div",{ref:this.setNode,className:P.Slidable,onMouseDown:this.startDrag,onTouchStart:this.startDrag},g,l,o,h,p,c.createElement("div",{style:i,className:P.Dragger,ref:this.setDraggerNode}))}handleResize(){const{onDraggerHeight:t}=this.props;if(!t)return;const{draggerNode:e}=this;e&&t(e.clientWidth)}}function Ie(s){return s.type==="mousemove"}function Ae(s){return s.type==="mousedown"}class _e extends w.PureComponent{constructor(...t){super(...t),this.state={sliderHeight:0,draggerHeight:0},this.node=null,this.setNode=e=>{e&&(this.node=e)},this.setSliderHeight=()=>{const{node:e}=this;e&&this.setState({sliderHeight:e.clientHeight})},this.setDraggerHeight=e=>{this.setState({draggerHeight:e})},this.handleChange=({y:e})=>{const{onChange:r}=this.props,{sliderHeight:n}=this.state,i=De(e,n);r(i)}}componentWillUnmount(){var t;(t=this.observer)==null||t.disconnect()}componentDidMount(){this.node&&(this.observer=new ResizeObserver(this.setSliderHeight),this.observer.observe(this.node),this.setSliderHeight())}render(){const{color:t,alpha:e}=this.props,{sliderHeight:r,draggerHeight:n}=this.state,i=ke(e,r,n),l=Oe(t);return c.createElement("div",{className:P.AlphaPicker,ref:this.setNode},c.createElement("div",{className:P.ColorLayer,style:{background:l}}),c.createElement(B,{draggerY:i,draggerX:0,onChange:this.handleChange,onDraggerHeight:this.setDraggerHeight}))}}function Oe(s){const{red:t,green:e,blue:r}=Q(s),n=`${t}, ${e}, ${r}`;return`linear-gradient(to top, rgba(${n}, 0) 18px, rgba(${n}, 1) calc(100% - 18px))`}const T=13;function Re(s,t,e){const r=$e(s,t,e);return S(r,0,t)}function Te(s,t){const e=S(s,0,t);return Le(e,t)}function Le(s,t){const e=s-T,r=t-T*2;return S(e/r*360,0,360)}function $e(s,t,e){const r=t-(e+T);return S(s/360*r+T,0,t-e)}class ze extends w.PureComponent{constructor(...t){super(...t),this.state={sliderHeight:0,draggerHeight:0},this.node=null,this.setNode=e=>{e&&(this.node=e)},this.setSliderHeight=()=>{const{node:e}=this;e&&this.setState({sliderHeight:e.clientHeight})},this.setDraggerHeight=e=>{this.setState({draggerHeight:e})},this.handleChange=({y:e})=>{const{onChange:r}=this.props,{sliderHeight:n}=this.state,i=Te(e,n);r(i)}}componentWillUnmount(){var t;(t=this.observer)==null||t.disconnect()}componentDidMount(){this.node&&(this.observer=new ResizeObserver(this.setSliderHeight),this.observer.observe(this.node),this.setSliderHeight())}render(){const{hue:t}=this.props,{sliderHeight:e,draggerHeight:r}=this.state,n=Re(t,e,r);return c.createElement("div",{className:P.HuePicker,ref:this.setNode},c.createElement(B,{draggerY:n,draggerX:0,onChange:this.handleChange,onDraggerHeight:this.setDraggerHeight}))}}const U=200;class Be extends w.PureComponent{constructor(...t){super(...t),this.state={pickerSize:{width:0,height:0}},this.colorNode=null,this.handleResize=de(()=>{const{colorNode:e}=this;e!=null&&this.setState({pickerSize:{width:e.clientWidth,height:e.clientHeight}})},U,{leading:!0,trailing:!0,maxWait:U}),this.setColorNode=e=>{this.colorNode=e},this.handleHueChange=e=>{const{color:{brightness:r,saturation:n,alpha:i=1},onChange:l}=this.props;l({hue:e,brightness:r,saturation:n,alpha:i})},this.handleAlphaChange=e=>{const{color:{hue:r,brightness:n,saturation:i},onChange:l}=this.props;l({hue:r,brightness:n,saturation:i,alpha:e})},this.handleDraggerMove=({x:e,y:r})=>{const{pickerSize:n}=this.state,{color:{hue:i,alpha:l=1},onChange:o}=this.props,g=S(e/n.width,0,1),h=S(1-r/n.height,0,1);o({hue:i,saturation:g,brightness:h,alpha:l})},this.handlePickerDrag=e=>{e.preventDefault()}}componentWillUnmount(){var t;(t=this.observer)==null||t.disconnect()}componentDidMount(){const{colorNode:t}=this;t&&(this.observer=new ResizeObserver(this.handleResize),this.observer.observe(t),this.setState({pickerSize:{width:t.clientWidth,height:t.clientHeight}}))}render(){const{id:t,color:e,allowAlpha:r,fullWidth:n}=this.props,{hue:i,saturation:l,brightness:o,alpha:g}=e,{pickerSize:h}=this.state,p=g!=null&&r?g:1,{red:m,green:x,blue:u}=Q({hue:i,saturation:1,brightness:1}),b=`rgba(${m}, ${x}, ${u}, ${p})`,j=S(l*h.width,0,h.width),d=S(h.height-o*h.height,0,h.height),v=r?c.createElement(_e,{alpha:p,color:e,onChange:this.handleAlphaChange}):null,f=G(P.ColorPicker,n&&P.fullWidth);return c.createElement("div",{className:f,id:t,onMouseDown:this.handlePickerDrag},c.createElement("div",{ref:this.setColorNode,className:P.MainColor},c.createElement("div",{className:P.ColorLayer,style:{backgroundColor:b}}),c.createElement(B,{onChange:this.handleDraggerMove,draggerX:j,draggerY:d})),c.createElement(ze,{hue:i,onChange:this.handleHueChange}),v)}}var Ye={Divider:"Polaris-Divider"};const V=({borderColor:s="border-secondary",borderWidth:t="025"})=>{const e=s==="transparent"?s:`var(--p-color-${s})`;return c.createElement("hr",{className:Ye.Divider,style:{borderBlockStart:`var(--p-border-width-${t}) solid ${e}`}})};var y={Select:"Polaris-Select",disabled:"Polaris-Select--disabled",error:"Polaris-Select--error",Backdrop:"Polaris-Select__Backdrop",Input:"Polaris-Select__Input",Content:"Polaris-Select__Content",InlineLabel:"Polaris-Select__InlineLabel",Icon:"Polaris-Select__Icon",SelectedOption:"Polaris-Select__SelectedOption",Prefix:"Polaris-Select__Prefix",hover:"Polaris-Select--hover",toneMagic:"Polaris-Select--toneMagic"};const W="";function X({options:s,label:t,labelAction:e,labelHidden:r,labelInline:n,disabled:i,helpText:l,placeholder:o,id:g,name:h,value:p=W,error:m,onChange:x,onFocus:u,onBlur:b,requiredIndicator:j,tone:d}){const{value:v,toggle:f}=ge(!1),E=w.useId(),C=g??E,N=n?!0:r,k=G(y.Select,m&&y.error,d&&y[pe("tone",d)],i&&y.disabled),se=w.useCallback(H=>{f(),u==null||u(H)},[u,f]),re=w.useCallback(H=>{f(),b==null||b(H)},[b,f]),ae=x?H=>x(H.currentTarget.value,C):void 0,_=[];l&&_.push(be(C)),m&&_.push(`${C}Error`);let O=(s||[]).map(Ue);o&&(O=[{label:o,value:W,disabled:!0},...O]);const ne=n&&c.createElement(fe,{paddingInlineEnd:"100"},c.createElement(D,{as:"span",variant:"bodyMd",tone:d&&d==="magic"&&!v?"magic-subdued":"subdued",truncate:!0},t)),L=Ve(O,p),ie=L.prefix&&c.createElement("div",{className:y.Prefix},L.prefix),le=c.createElement("div",{className:y.Content,"aria-hidden":!0,"aria-disabled":i},ne,ie,c.createElement("span",{className:y.SelectedOption},L.label),c.createElement("span",{className:y.Icon},c.createElement(J,{source:me}))),oe=O.map(Xe);return c.createElement(ve,{id:C,label:t,error:m,action:e,labelHidden:N,helpText:l,requiredIndicator:j,disabled:i},c.createElement("div",{className:k},c.createElement("select",{id:C,name:h,value:p,className:y.Input,disabled:i,onFocus:se,onBlur:re,onChange:ae,"aria-invalid":!!m,"aria-describedby":_.length?_.join(" "):void 0,"aria-required":j},oe),le,c.createElement("div",{className:y.Backdrop})))}function F(s){return typeof s=="string"}function Y(s){return typeof s=="object"&&"options"in s&&s.options!=null}function Z(s){return{label:s,value:s}}function Ue(s){if(F(s))return Z(s);if(Y(s)){const{title:t,options:e}=s;return{title:t,options:e.map(r=>F(r)?Z(r):r)}}return s}function Ve(s,t){const e=We(s);let r=e.find(n=>t===n.value);return r===void 0&&(r=e.find(n=>!n.hidden)),r||{value:"",label:""}}function We(s){let t=[];return s.forEach(e=>{Y(e)?t=t.concat(e.options):t.push(e)}),t}function q(s){const{value:t,label:e,prefix:r,key:n,...i}=s;return c.createElement("option",Object.assign({key:n??t,value:t},i),e)}function Xe(s){if(Y(s)){const{title:t,options:e}=s;return c.createElement("optgroup",{label:t,key:t},e.map(q))}return q(s)}class K{static rgbToHex({red:t,green:e,blue:r}){return"#"+[t,e,r].map(n=>n.toString(16).padStart(2,"0")).join("")}static hsbToRgb({hue:t,saturation:e,brightness:r}){const n=e*100/100,i=r*100/100,l=i*n,o=t*100/60,g=l*(1-Math.abs(o%2-1));let h=0,p=0,m=0;o>=0&&o<1?(h=l,p=g,m=0):o>=1&&o<2?(h=g,p=l,m=0):o>=2&&o<3?(h=0,p=l,m=g):o>=3&&o<4?(h=0,p=g,m=l):o>=4&&o<5?(h=g,p=0,m=l):o>=5&&o<=6&&(h=l,p=0,m=g);const x=i-l;return{red:Math.round((h+x)*255),green:Math.round((p+x)*255),blue:Math.round((m+x)*255)}}}const Fe=({option:s,setOption:t})=>{var u,b,j;const e=d=>d.style.includes("Image")?a.jsx("img",{src:d.image}):a.jsx("div",{className:"option-setting-preview flex pt-1 pb-1",children:a.jsx("div",{className:"border-gray-300 border-1 rounded-md flex flex-col",style:{width:"var(--p-width-800)",height:"var(--p-height-800)",borderRadius:"var(--p-border-radius-200)"},children:d.color.split(",").map((v,f)=>a.jsx("div",{style:{width:"100%",height:`${100/d.color.split(",").length}%`,background:v,borderTopRightRadius:f===0?"var(--p-border-radius-200)":"0px",borderTopLeftRadius:f===0?"var(--p-border-radius-200)":"0px",borderBottomRightRadius:f===d.color.split(",").length-1?"var(--p-border-radius-200)":"0px",borderBottomLeftRadius:f===d.color.split(",").length-1?"var(--p-border-radius-200)":"0px"}},`color-${f}`))})}),[r,n]=w.useState(0),[i,l]=w.useState(!1),o=(d,v)=>{if(s.values&&s.values[d]){const E=s.values[d].color.split(",").filter((N,k)=>k!==v),C=s.values.map((N,k)=>k===d?{...N,color:E.join(",")}:N);t({...s,values:C})}},g=(d,v)=>{if(d.style.includes("Image"))return a.jsx("div",{className:"option-setting-upload flex justify-center",children:a.jsx(M,{icon:te,size:"large",variant:"tertiary",accessibilityLabel:"Upload"})});const f=d.color.split(",");return a.jsxs("div",{className:"option-setting-upload relative flex justify-center gap-2 items-center",children:[d.color&&f.map((E,C)=>a.jsxs("div",{className:"relative group",style:{width:"var(--p-width-800)",height:"var(--p-height-800)"},children:[a.jsx("button",{className:"border-gray-300 border-1 w-full h-full",style:{background:E,borderRadius:"var(--p-border-radius-200)"}}),a.jsx("div",{className:"absolute -top-1 -right-1 rounded-full w-4 h-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-amber-50 hover:bg-amber-50",onClick:()=>o(v,C),children:a.jsx(J,{source:Ce})})]},`color-${C}`)),f.length<5&&a.jsx("div",{className:"flex justify-center ml-1.5",children:a.jsx(M,{onClick:()=>{n(v),l(!0)},icon:ee,size:"large",variant:"tertiary",accessibilityLabel:"Add"})})]})},[h,p]=w.useState({hue:0,saturation:0,brightness:100,alpha:1}),m=()=>{const d=K.hsbToRgb(h),v=K.rgbToHex(d);if(s.values&&s.values[r]){const E=[...s.values[r].color?s.values[r].color.split(","):[],v],C=s.values.map((N,k)=>k===r?{...N,color:E.join(",")}:N);t({...s,values:C})}l(!1)},x=[{title:"Value"},{title:(u=s.style)!=null&&u.includes("Color")?"Status":"Preview"},{title:""}];return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:`absolute border-gray-300 border-1 rounded-md flex flex-col 
          gap-4 pl-2 pr-2 ${i?"block":"hidden"}`,style:{bottom:"70px",right:"20px",zIndex:1e3,background:"var(--p-color-bg-fill)"},children:[a.jsx(Be,{color:h,onChange:d=>{p(d)}}),a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx(M,{onClick:()=>l(!1),variant:"tertiary",children:"Cancel"}),a.jsx(M,{variant:"tertiary",onClick:m,children:"Add"})]})]}),a.jsx(xe,{children:a.jsx(A,{resourceName:{singular:"value",plural:"values"},itemCount:((b=s.values)==null?void 0:b.length)??0,selectable:!0,headings:x,children:(j=s.values)==null?void 0:j.map((d,v)=>a.jsxs(A.Row,{id:d.value+v,rowType:"data",position:v,children:[a.jsx(A.Cell,{className:"text-start",children:a.jsx(D,{as:"span",children:d.value})}),a.jsx(A.Cell,{className:"text-start",children:a.jsx("div",{className:"option-setting-preview",children:e(d)})}),a.jsx(A.Cell,{className:"text-start max-w-17",children:g(d,v)})]},d.value+v))})})]})},Ze={"home-page":"Home page","collection-page":"Collection page","product-page":"Product page"},qe=({option:s,setOption:t})=>{var m,x;const e=[{label:"Swatch",value:"Swatch",options:[{label:"Color",value:"Color"},{label:"Image",value:"Image"}]},{label:"Button",value:"Button",options:[{label:"Text",value:"Text"},{label:"Image and text",value:"ImageText"}]},{label:"Dropdown",value:"Dropdown",options:[{label:"Color and text",value:"ColorText"},{label:"Image and text",value:"ImageText"}]}],r=["product-page","collection-page","home-page"],n=()=>{s&&t({...s,isActive:!(s!=null&&s.isActive)})},i=he(),l=()=>{i({to:Pe.KeepParameters("/")})},o=((m=e.find(u=>u.value===((s==null?void 0:s.template)??"Swatch")))==null?void 0:m.options)??[],g=u=>{var b;t({...s,template:u,style:((b=o[0])==null?void 0:b.value)??"Color"})},h=u=>{t({...s,style:u})},p=(u,b)=>{s&&t({...s,position:b?[...s.position,u]:s.position.filter(j=>j!==u)})};return a.jsxs(Se,{primaryAction:a.jsx(M,{variant:"primary",children:"Save"}),backAction:{content:(s==null?void 0:s.name)||"Option",onAction:l},title:(s==null?void 0:s.name)||"Option",subtitle:`${((x=s==null?void 0:s.values)==null?void 0:x.length)??0} value`,children:[!s&&a.jsx(we,{lines:8}),s&&a.jsxs($,{gap:"400",children:[a.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[a.jsxs($,{gap:"200",children:[a.jsx(D,{variant:"headingMd",as:"h3",children:"Active widget to display your swatches"}),a.jsx(D,{variant:"bodyMd",as:"span",tone:"subdued",children:"Allow widget to display on the page you want"})]}),a.jsx("div",{className:"option-active",children:a.jsx(ye,{title:"Active widget",action:{content:s.isActive?"Inactive":"Active",onAction:n},details:"Allow widget to display on the page you want"})})]}),a.jsx("div",{className:"mt-8 mb-8",children:a.jsx(V,{borderColor:"border"})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs($,{gap:"200",children:[a.jsx(D,{variant:"headingMd",as:"h3",children:"Setting"}),a.jsx(D,{variant:"bodyMd",as:"span",tone:"subdued",children:"Setting layout, active template and choose page to display"})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"flex flex-row gap-5 justify-between items-end option-setting-template",children:[a.jsx(X,{label:"Template",options:e.map(u=>({label:u.label,value:u.value})),value:s.template??"Swatch",onChange:g}),a.jsx(X,{label:"Style",options:o,value:s.style??"Color",onChange:h}),a.jsx(M,{size:"medium",children:"Customize"})]}),a.jsxs("div",{className:"flex flex-col gap-3.5",children:[a.jsx(D,{variant:"bodyMd",as:"span",tone:"subdued",children:"Position"}),a.jsx("div",{className:"flex flex-row gap-10",children:r.map(u=>a.jsx(je,{label:Ze[u],checked:s.position.includes(u),onChange:b=>p(u,b)},u))})]})]})]}),a.jsx("div",{className:"mt-8 mb-8",children:a.jsx(V,{borderColor:"border"})}),a.jsx(Fe,{option:s,setOption:t})]})]})},Qe=function(){const{id:t}=ue.useParams(),[e,r]=w.useState(void 0),{getOptionById:n,getOptionSettings:i}=Ne();w.useEffect(()=>{(async()=>{const g=n(t);if(g)r(g);else{await i();const h=n(t);r(h)}})()},[t,n,i]);const l=o=>{e&&r({...e,...o})};return a.jsx(qe,{option:e,setOption:l})};export{Qe as component};
